paste(dx$l1,dx$l2)
),]$value)
sum(lx)
ling.domain$cult.dist = NA
lx = ling.domain$imputed_semantic_domain==dom
ling.domain[lx,]$cult.dist = dx[match(
paste(ling.domain[lx,]$l1,ling.domain[lx,]$l2),
paste(dx$l1,dx$l2)
),]$value
hist(ling.domain$cult.dist)
setwd("~/Documents/Bristol/word2vec/word2vec_DPLACE/processing/")
l = read.csv("../data/FAIR_langauges_glotto_xdid.csv",
stringsAsFactors = F)
ling.domain = read.csv("../data/FAIR/semantic_distances_by_domain.csv", stringsAsFactors = F)
ling.domain$cult.dist = NA
ling.langs = unique(c(ling.domain$l1,
ling.domain$l2))
domains = unique(ling.domain$imputed_semantic_domain)
for(dom in domains){
dom.filename = paste0('../results/EA_distances/',
gsub(" ","_",dom),"_long.csv")
if(file.exists(dom.filename)){
print(dom)
dx = read.csv(dom.filename, stringsAsFactors = F)
dx$l1 = l[match(dx$Var1,l$Language2),]$iso2
dx$l2 = l[match(dx$Var2,l$Language2),]$iso2
dx = dx[dx$l1 %in% ling.langs & dx$l2 %in% ling.langs,]
lx = ling.domain$imputed_semantic_domain==dom
ling.domain[lx,]$cult.dist = dx[match(
paste(ling.domain[lx,]$l1,ling.domain[lx,]$l2),
paste(dx$l1,dx$l2)
),]$value
}
}
sum(!is.na(ling.domain$cult.dist))
nrow(ling.domain)
length(unique(ling.domain$imputed_semantic_domain))
write.csv("../results/EA_distances/All_Domains_with_ling.csv", row.names = F)
write.csv(ling.domain,"../results/EA_distances/All_Domains_with_ling.csv", row.names = F)
head(ling.domain)
ling.domain = ling.domain[,names(ling.domain)!="X"]
write.csv(ling.domain,"../results/EA_distances/All_Domains_with_ling.csv", row.names = F)
head(ling.domain)
ling.dom = read.csv(
"../results/EA_distances/All_Domains_with_ling.csv",
stringsAsFactors = F)
ling.dom = ling.dom[!is.na(ling.dom$cult.dist),]
head(ling.dom)
ling.dom$family1 = l[match(ling.dom$l1, l$iso2),]$family
ling.dom$family1
ling.dom = read.csv(
"../results/EA_distances/All_Domains_with_ling.csv",
stringsAsFactors = F)
ling.dom = ling.dom[!is.na(ling.dom$cult.dist),]
ling.dom$family1 = l[match(ling.dom$l1, l$iso2),]$family
ling.dom$family2 = l[match(ling.dom$l2, l$iso2),]$family
ling.dom$family.group = paste(ling.dom$family1,
ling.dom$family2)
ling.dom$area1 = l[match(ling.dom$l1, l$iso2),]$area
ling.dom$area2 = l[match(ling.dom$l2, l$iso2),]$area
ling.dom$area.group = paste(ling.dom$area1,
ling.dom$area2)
l[match(ling.dom$l1, l$iso2),]$area
ling.dom$area1 = l[match(ling.dom$l1, l$iso2),]$autotyp.area
ling.dom$area2 = l[match(ling.dom$l2, l$iso2),]$autotyp.area
ling.dom$area.group = paste(ling.dom$area1,
ling.dom$area2)
head(l)
head(ling.dom)
mD0 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 + cult.dist.center | area.group),
data = ling.dom
)
ling.dom$cult.dist.center = scale(ling.dom$cult.dist)
ling.dom$rho.center = scale(ling.dom$rho)
mD0 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 + cult.dist.center | area.group),
data = ling.dom
)
plot(ling.dom$rho.center, ling.dom$cult.dist)
length(unique(ling.dom$l1))
mD0 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 + cult.dist.center | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom
)
mD0 = lmer(
rho.center ~ 1 +
(1 | family.group) +
(1 | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom
)
summary(mD0)
hist(ling.dom$rho.center)
hist(ling.dom$cult.dist.center)
mD1 = lmer(
rho.center ~ 1 +
cult.dist.center +
(1 | family.group) +
(1 | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom
)
anova(mD0,mD1)
mD0 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center || family.group) +
(1 | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom
)
mD0 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center || family.group) +
(1 + cult.dist.center || area.group) +
(1 | imputed_semantic_domain),
data = ling.dom
)
mD0 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center || family.group) +
(1 + cult.dist.center | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom
)
mD0 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 + cult.dist.center || area.group) +
(1 | imputed_semantic_domain),
data = ling.dom
)
mD0 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center || family.group) +
(1 + cult.dist.center || area.group) +
(1 | imputed_semantic_domain),
data = ling.dom,
control = lmerControl(optimizer = 'bobyqa')
)
mD0 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 + cult.dist.center || area.group) +
(1 | imputed_semantic_domain),
data = ling.dom,
control = lmerControl(optimizer = 'bobyqa')
)
mD0 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 + cult.dist.center | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom,
control = lmerControl(optimizer = 'bobyqa')
)
mD0 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 + cult.dist.center | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom,
control = lmerControl(optimizer = 'Nelder_Mead')
)
mD0 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 + cult.dist.center | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom,
control = lmerControl(optimizer = 'Nelder_Mead',
optCtrl = list(maxfun=1000000))
)
mD0 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 + cult.dist.center | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom,
control = lmerControl(optimizer = c('Nelder_Mead','bobyqa'),
optCtrl = list(maxfun=1000000))
)
c('Nelder_Mead','bobyqa')
mD0 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 + cult.dist.center | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom,
control = lmerControl(optimizer = 'bobyqa',
optCtrl = list(maxfun=1000000))
)
mD0 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 + cult.dist.center || area.group) +
(1 | imputed_semantic_domain),
data = ling.dom,
control = lmerControl(optimizer = 'bobyqa',
optCtrl = list(maxfun=1000000))
)
mD0 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 + cult.dist.center || area.group) +
(1 | imputed_semantic_domain),
data = ling.dom,
control = lmerControl(optimizer = 'bobyqa',
optCtrl = list(maxfun=1000000))
)
mD1 = lmer(
rho.center ~ 1 +
cult.dist.center +
(1 + cult.dist.center | family.group) +
(1 + cult.dist.center || area.group) +
(1 | imputed_semantic_domain),
data = ling.dom
)
anova(mD0,mD1)
summary(mD1)
sjp.lmer(mD1, "re")
mD1
?sjp.lmer
sjp.lmer(mD1, "re")
library(lattice)
mD0 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 + cult.dist.center || area.group) +
(1 | imputed_semantic_domain),
data = ling.dom)
mD0 = lmer(
rho.center ~ 1 +
(1 | family.group) +
(1 | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom)
mD1 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom)
anova(mD0,mD1)
mD2 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 | area.group) +
(0 + cult.dist.center | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom)
anova(mD1,mD2)
anova(mD0,mD1)
mD0 = lmer(
rho.center ~ 1 +
(1 | family.group) +
(1 | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom)
mD1 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(0 + cult.dist.center | family.group) +
(1 | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom)
mD2 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom)
anova(mD0,mD1,mD2)
mD0 = lmer(
rho.center ~ 1 +
(1 | family.group) +
(1 | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom)
mD1 = lmer(
rho.center ~ 1 +
(1 | family.group) +
(0 + cult.dist.center | family.group) +
(1 | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom)
mD2 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom)
anova(mD0,mD1,mD2)
mD3 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(0 + cult.dist.center | family.group) +
(1 | area.group) +
(0 + cult.dist.center | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom)
anova(mD1,mD3)
mD3 = lmer(
rho.center ~ 1 +
(1 | family.group) +
(0 + cult.dist.center | family.group) +
(1 | area.group) +
(0 + cult.dist.center | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom)
anova(mD1,mD3)
mD4 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom)
mD5 = udpate(mD4, ~.+cult.dist.center)
mD5 = update(mD4, ~.+cult.dist.center)
summary(mD5)
sjp.lmer(mD5, "re")
mD4 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 | area.group) +
(1 | imputed_semantic_domain),
data = ling.dom)
ranef(mD4)
mD5 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 | imputed_semantic_domain),
data = ling.dom)
mD6 = update(mD5, ~.+cult.dist.center)
anova(mD5,mD6)
sjp.lmer(mD6, "re")
mD5 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center || family.group) +
(1 | imputed_semantic_domain),
data = ling.dom)
mD6 = update(mD5, ~.+cult.dist.center)
anova(mD5,mD6)
sjp.lmer(mD6, "re")
library(lattice)
dotplot(ranef(mD6))
summary(mD6)
dim(ling.dom)
sjp.lmer(mD6,'eff')
sjp.lmer(mD6,'eff', show.ci = T)
mD5 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center || family.group) +
(1 | imputed_semantic_domain),
data = ling.dom)
mD6 = update(mD5, ~.+cult.dist.center)
sjp.lmer(mD6,'eff', show.ci = T)
sjp.lmer(mD6,'eff', show.ci = T, show.scatter = T)
?sjp.lmer
sjp.lmer(mD5,'ri.slope')
sjp.lmer(mD5,'eff.ri')
sjp.lmer(mD6,'eff', show.ci = T)
sjp.lmer(mD5,'eff.ri')
sjp.lmer(mD5,'ri.slope')
mD5 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 | imputed_semantic_domain),
data = ling.dom)
mD6 = update(mD5, ~.+cult.dist.center)
sjp.lmer(mD5,'ri.slope')
sjp.lmer(mD6,'ri.slope')
sjp.lmer(mD6,'eff.re')
?sjp.lmer
sjp.lmer(mD6,'eff.ri')
sjp.lmer(mD6,'ri.slope')
sjp.lmer(mD6,'eff.ri')
mD5 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 + cult.dist.center | imputed_semantic_domain),
data = ling.dom)
mD6 = update(mD5, ~.+cult.dist.center)
anova(mD5,mD6)
summary(mD6)
dotplot(ranef(mD6))
sjp.lmer(mD6,'eff', show.ci = T)
sjp.lmer(mD6,'ri.slope')
sjp.lmer(mD6,'eff.ri')
sjp.lmer(mD6,'rs.ri')
sjp.lmer(mD6,'rs.ri', show.ci = T)
sjp.lmer(mD6,'fe.slope', show.ci = T)
sjp.lmer(mD6,'fe.slope')
mD5 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 + cult.dist.center | imputed_semantic_domain),
data = ling.dom)
mD6 = update(mD5, ~.+cult.dist.center)
anova(mD5,mD6)
mD5 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center || family.group) +
(1 + cult.dist.center || imputed_semantic_domain),
data = ling.dom)
mD6 = update(mD5, ~.+cult.dist.center)
anova(mD5,mD6)
mD5 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 + cult.dist.center | imputed_semantic_domain),
data = ling.dom)
mD6 = update(mD5, ~.+cult.dist.center)
anova(mD5,mD6)
sjp.lmer(mD6,'rs.ri', show.ci = T)
px = sjp.lmer(mD6,'rs.ri', show.ci = T)
px$data
px$plot
px$plot[[2]]
px$plot[[2]]$data
head(px$plot[[2]]$data)
ggplot(px$plot[[2]]$data,
aes(x,y,group=grp)) +
geom_line()
ggplot(px$plot[[2]]$data,
aes(x,y,colour=grp)) +
geom_line()
ggplot(px$plot[[2]]$data,
aes(x,y,colour=grp)) +
geom_line()
pdx = px$plot[[2]]$data
ranef(mD6)$imputed_semantic_domain
dom.order = ranef(mD6)$imputed_semantic_domain
rownames(dom.order[order(dom.order$cult.dist.center),])
sjp.lmer(mD6,'eff', show.ci = T)
dom.order = ranef(mD6)$imputed_semantic_domain
dom.order = rownames(dom.order[order(dom.order$cult.dist.center),])
px = sjp.lmer(mD6,'rs.ri', show.ci = T, prnt.plot = F)
pdx = px$plot[[2]]$data
pdx$grp = factor(pdx$grp, levels = dom.order)
ggplot(px$plot[[2]]$data,
aes(x,y,colour=grp)) +
geom_line()
ggplot(pdx,
aes(x,y,colour=grp)) +
geom_line()
pdx$Domain = factor(pdx$grp, levels = dom.order)
ggplot(pdx,
aes(x,y,colour=Domain)) +
geom_line()
sjp.lmer(mD6,'rs.ri')
?attr
attr(ling.dom$cult.dist,"scaled:scale")
px = sjp.lmer(mD6,'rs.ri', show.ci = T, prnt.plot = F)
pdx = px$plot[[2]]$data
pdx$Domain = factor(pdx$grp, levels = dom.order)
pdx$x = pdx$x *
attr(ling.dom$cult.dist.center,"scaled:scale") +
attr(ling.dom$cult.dist.center,"scaled:center")
pdx$y = pdx$y *
attr(ling.dom$rho.center,"scaled:scale") +
attr(ling.dom$rho.center,"scaled:center")
ggplot(pdx,
aes(x,y,colour=Domain)) +
geom_line() +
xlab("Cultural Distance") +
ylab("Linguistic distance (rho)")
mD5 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center | family.group) +
(1 + cult.dist.center | imputed_semantic_domain),
data = ling.dom[ling.dom$imputed_semantic_domain!="Religion and belief",])
mD6 = update(mD5, ~.+cult.dist.center)
anova(mD5,mD6)
mD5 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center || family.group) +
(1 + cult.dist.center | imputed_semantic_domain),
data = ling.dom)
mD6 = update(mD5, ~.+cult.dist.center)
anova(mD5,mD6)
sjp.lmer(mD6,'eff', show.ci = T)
dom.order = ranef(mD6)$imputed_semantic_domain
dom.order = rownames(dom.order[order(dom.order$cult.dist.center),])
px = sjp.lmer(mD6,'rs.ri', show.ci = T, prnt.plot = F)
pdx = px$plot[[2]]$data
pdx$Domain = factor(pdx$grp, levels = dom.order)
pdx$x = pdx$x *
attr(ling.dom$cult.dist.center,"scaled:scale") +
attr(ling.dom$cult.dist.center,"scaled:center")
pdx$y = pdx$y *
attr(ling.dom$rho.center,"scaled:scale") +
attr(ling.dom$rho.center,"scaled:center")
ggplot(pdx,
aes(x,y,colour=Domain)) +
geom_line() +
xlab("Cultural Distance") +
ylab("Linguistic distance (rho)")
mD5 = lmer(
rho.center ~ 1 +
(1 + cult.dist.center || family.group) +
(1 + cult.dist.center | imputed_semantic_domain),
data = ling.dom)
mD6 = update(mD5, ~.+cult.dist.center)
anova(mD5,mD6)
