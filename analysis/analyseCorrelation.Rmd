---
title: "Cultural distances: controlling for history"
output: pdf_document
---

```{r echo=F, eval=F}
setwd("~/Documents/Bristol/word2vec/word2vec_DPLACE/analysis/")
```

# Introduction

We compare cultural distances between socieites with linguistic distances between societies in Indo-European languages, controlling for history using a phylogenetic tree.  The tree comes from Bouckaert et al. (2012).  Patristic distances between languages are used as a measure of historical distance between societies. There is no easy way to do such a regression due to the main measures are in the form of distance matrices.

# Load libraries
```{r warning=F, message=F}
library(ape)
library(ecodist)
```

# Load data

Read the cultural distances:

```{r}
cult = read.csv("../results/EA_distances/CulturalDistances_Long.csv", stringsAsFactors = F)
```

Add language family:

```{r}
l = read.csv("../data/FAIR_langauges_glotto_xdid.csv", stringsAsFactors = F)
g = read.csv("../data/glottolog-languoid.csv/languoid.csv", stringsAsFactors = F)
l$family = g[match(l$glotto,g$id),]$family_pk
l$family = g[match(l$family,g$pk),]$name
```

Read the semantic distances

```{r}
ling = read.csv("../data/FAIR/semantic_distances_FAIR.csv", stringsAsFactors = F)
ling$rho.center = scale(ling$rho)

```

# LMER models

## Indo-European

```{r}
m0 = lmer(
  rho.center ~
    historical
)
```

# Mantel tests

Read the historical distances for Indo-European, based on the phylogenetic distances.

```{r}
hist = read.csv("../data/trees/IndoEuropean_historical_distances.csv", stringsAsFactors = F)
rownames(hist) = hist[,1]
hist = hist[,2:ncol(hist)]
```

Read the cultural distances as a matrix:

```{r}
cult.m = read.csv("../results/EA_distances/CulturalDistances.csv", stringsAsFactors = F)
rownames(cult.m) = cult.m[,1]
cult.m = cult.m[,2:ncol(cult.m)]
```


## Indo-European

Simple correlation without control for history:

```{r}
ecodist::mantel(as.dist(cult.m) ~
                as.dist(ling),
                nperm = 10000)
```


Run a mantel test comparing the linguistic distances to the cultural distances, controlling for the historical distance between languages:

```{r}
ecodist::mantel(as.dist(cult)~
                  as.dist(ling) + 
                  as.dist(t.dist),
                nperm = 10000)
```

# References

Bouckaert, Remco, Philippe Lemey, Michael Dunn, Simon J. Greenhill, Alexander V. Alekseyenko, Alexei J. Drummond, Russell D. Gray, Marc A. Suchard, and Quentin D. Atkinson (2012). Mapping the origins and expansion of the Indo-European language family. Science, 337(6097), 957-960.